<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ë¬¸í™”ê³µê° ì˜ˆì•½ ì‹ ì²­ì„œ</title>
    <style th:replace="fragments.html :: head-style"></style>
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
</head>
<div th:replace="fragments.html :: head-link"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"
        integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ=="
        crossorigin="anonymous"></script>
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css"
      integrity="sha512-mSYUmp1HYZDFaVKK//63EcZq4iFWFjxSL+Z3T/aCt4IO9Cejm03q3NKKYN6pFQzY0SBOr8h+eCIAZHPXcpZaNw=="
      crossorigin="anonymous"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.ko.min.js"
        integrity="sha512-L4qpL1ZotXZLLe8Oo0ZyHrj/SweV7CieswUODAAPN/tnqN3PA1P+4qPu5vIryNor6HQ5o22NujIcAZIfyVXwbQ=="
        crossorigin="anonymous"></script>
<body class="bg-light">
<div class="container">
    <div class="row">
        <div class="col">
            <h1 class="mt-3 text-center">ğŸ’™ê¾¸ë§ˆ 2ì¸µ ë¬¸í™”ê³µê°ğŸ’š
                <br/>
                ì˜¨ë¼ì¸ ì˜ˆì•½ ì‹ ì²­ì„œ ì‘ì„±í•˜ê¸° </h1>
            <form id="booking-form" class="needs-validation" th:action="@{/book/submit}" th:object="${visitor}"
                  method="post"  novalidate>
                <!-- ì´ë¦„ -->
                <div class="form-group">
                    <label for="name">ğŸ”¸ ì´ë¦„</label>
                    <input id="name" th:field="*{name}" name="name" type="text" class="form-control" required/>
                    <small class="invalid-feedback">ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.</small>
                    <small class="form-text text-danger" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">
                        name Error
                    </small>
                </div>
                <!-- íŒ¨ìŠ¤ì›Œë“œ -->
                <div class="form-group">
                    <label for="password">ğŸ”¸ íŒ¨ìŠ¤ì›Œë“œ</label>
                    <input id="password" th:field="*{password}" name="password" type="password" class="form-control"
                           aria-describedby="passwordHelp" required/>
                    <small id="passwordHelp" class="text-muted form-text">íŒ¨ìŠ¤ì›Œë“œëŠ” ì˜ˆì•½ ìˆ˜ì • ë° ì‚­ì œ ì‹œ ì‚¬ìš©ë©ë‹ˆë‹¤.</small>
                    <small class="invalid-feedback">ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.</small>
                    <small class="form-text text-danger" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">
                        password Error
                    </small>
                </div>


                <!-- ì „í™”ë²ˆí˜¸-->
                <div class="form-group">
                    <label for="phoneNumber">ğŸ”¸ ì „í™”ë²ˆí˜¸</label>
                    <input id="phoneNumber" th:field="*{phoneNumber}" name="phoneNumber" type="text"
                           class="form-control"
                           placeholder="010-0000-0000" aria-describedby="phoneNumberHelp" required
                           pattern="^\d{3}-\d{3,4}-\d{4}$"/>
                    <small id="phoneNumberHelp" class="form-text text-muted">
                        "-" ë¥¼ í¬í•¨í•œ íœ´ëŒ€í° ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”
                    </small>
                    <small class="invalid-feedback">"-" ë¥¼ í¬í•¨í•´ 010-0000-0000 í˜•ì‹ì˜ íœ´ëŒ€í° ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</small>
                    <small class="form-text text-danger" th:if="${#fields.hasErrors('phoneNumber')}"
                           th:errors="*{phoneNumber}">phone number Error</small>
                </div>
                <!-- ë‚˜ì´-->
                <div class="form-group">
                    <label for="age">ğŸ”¸ ë‚˜ì´</label>
                    <input id="age" th:field="*{age}" name="age" type="text" class="form-control" pattern="[0-9]{1,2}"
                           required/>
                    <small class="invalid-feedback">ì˜¬ë°”ë¥¸ ë‚˜ì´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</small>
                    <small class="form-text text-danger" th:if="${#fields.hasErrors('age')}" th:errors="*{age}">age
                        Error</small>
                </div>
                <!-- ì„±ë³„ -->
                <div class="form-group">
                    <label>ğŸ”¸ ì„±ë³„</label>
                    <div th:each="gender : ${T(me.cheonhwa.bookyouthspace.domain.Gender).values()}">
                        <div class="custom-control custom-radio custom-control-inline">
                            <input type="radio" th:field="*{gender}" th:value="${gender}" class="custom-control-input"
                                   required/>
                            <label class="custom-control-label" th:for="${#ids.prev('gender')}"
                                   th:text="${gender.equals(T(me.cheonhwa.bookyouthspace.domain.Gender).MALE)} ? 'ë‚¨ì' : 'ì—¬ì'">gender</label>
                        </div>
                    </div>
                </div>

                <!-- ì˜ˆì•½ ë‚ ì§œ -->
                <div class="form-group">
                    <label for="calender">ğŸ”¸ ì˜ˆì•½ ë‚ ì§œ</label>
                    <input id="calender" type="text" th:field="*{reservedDate}" class="form-control"
                           placeholder="ì—¬ê¸°ë¥¼ ëˆŒëŸ¬ ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”" required/>
                    <small class="invalid-feedback">ì˜ˆì•½ ë‚ ì§œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”</small>
                </div>
                <!-- ì˜ˆì•½ ì‹œê°„ -->
                <div class="form-group" id="time-part" style="display: none">
                    <label for="timetable">ğŸ’™ ì˜ˆì•½ ì‹œê°„</label>
                    <small class="text-muted form-text">ì˜ˆì•½ì€ ì¼ì£¼ì¼ ì „ë¶€í„° ë‹¹ì¼ ì˜¤ì „ 9ì‹œê¹Œì§€ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</small>
                    <table class="table" id="timetable">
                        <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">ì´ìš©ì‹œê°„</th>
                            <th scope="col">ì˜ˆì•½ê°€ëŠ¥ì¸ì› (í˜„ì¬ ì˜ˆì•½ì¸ì›)</th>
                            <th scope="col">ì˜ˆì•½í•  ì‹œê°„</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <th scope="row">1íƒ€ì„</th>
                            <td>ì˜¤ì „10:00 ~ 12:00</td>
                            <td id="1-timePart-personnel">-1</td>
                            <td>
                                <div class="form-check">
                                    <input id="1-timePart-radio" type="radio" th:field="*{reservedTimePart}"
                                           th:value="1"
                                           class="form-check-input" required/>
                                    <small class="invalid-feedback">ì˜ˆì•½ì‹œê°„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”</small>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">2íƒ€ì„</th>
                            <td>ë‚®12:30 ~ ì˜¤í›„2:30</td>
                            <td id="2-timePart-personnel">-1</td>
                            <td>
                                <div class="form-check">
                                    <input id="2-timePart-radio" type="radio" th:field="*{reservedTimePart}"
                                           th:value="2"
                                           class="form-check-input" required/>
                                    <small class="invalid-feedback">ì˜ˆì•½ì‹œê°„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”</small>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">3íƒ€ì„</th>
                            <td>ì˜¤í›„3:00 ~ 5:00</td>
                            <td id="3-timePart-personnel">-1</td>
                            <td>
                                <div class="form-check">
                                    <input id="3-timePart-radio" type="radio" th:field="*{reservedTimePart}"
                                           th:value="3"
                                           class="form-check-input" required/>
                                    <small class="invalid-feedback">ì˜ˆì•½ì‹œê°„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”</small>
                                </div>
                            </td>
                        </tr>
                        <tr id="4-time" style="display: none">
                            <th scope="row">4íƒ€ì„</th>
                            <td>ì˜¤í›„5:30 ~ 7:30</td>
                            <td id="4-timePart-personnel">-1</td>
                            <td>
                                <div class="form-check">
                                    <input id="4-timePart-radio" type="radio" th:field="*{reservedTimePart}"
                                           th:value="4"
                                           class="form-check-input" required/>
                                    <small class="invalid-feedback">ì˜ˆì•½ì‹œê°„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”</small>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <!-- ì´ìš© í•˜ê³  ì‹¶ì€ê²ƒ -->
                <div class="form-group">
                    <label>ğŸ”¸ ì´ìš©í•˜ê³  ì‹¶ì€ê²ƒ</label>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" th:field="*{contentsToUse.computer}"/>
                        <label class="form-check-label" th:text="${contentNames[0]}">
                            checkbox
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" th:field="*{contentsToUse.pocketBall}"/>
                        <label class="form-check-label" th:text="${contentNames[1]}">
                            checkbox
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" th:field="*{contentsToUse.pingPong}"/>
                        <label class="form-check-label" th:text="${contentNames[2]}">
                            checkbox
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" th:field="*{contentsToUse.boardGame}"/>
                        <label class="form-check-label" th:text="${contentNames[3]}">
                            checkbox
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" th:field="*{contentsToUse.restArea}"/>
                        <label class="form-check-label" th:text="${contentNames[4]}">
                            checkbox
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" th:field="*{contentsToUse.photoZone}"/>
                        <label class="form-check-label" th:text="${contentNames[5]}">
                            checkbox
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" th:field="*{contentsToUse.ps4}"/>
                        <label class="form-check-label" th:text="${contentNames[6]}">
                            checkbox
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" th:field="*{contentsToUse.arcadeConsole}"/>
                        <label class="form-check-label" th:text="${contentNames[7]}">
                            checkbox
                        </label>
                    </div>
                </div>

                <!-- ìµœì¢… ì˜ˆì•½ ìˆ˜ì • ì‹œê°„ : frontì—ì„œ ì €ì¥ì‹œ í´ë¼ì´ì–¸íŠ¸ íƒ€ì„ì¡´ì„ ê¸°ì¤€ìœ¼ë¡œ ì €ì¥ë˜ê¸° ë•Œë¬¸ì— back ì—ì„œ ë”°ë¡œ ì €ì¥í•œë‹¤.
                <div class="form-group">
                    <input type="datetime-local" th:field="*{reservationUpdateDateTime}" th:value="">
                </div>
                -->
                <div class="form-group">
                    <button id="form-submit" class="btn btn-primary btn-block" type="submit"
                            aria-describedby="submitHelp">ğŸ‘© ì˜ˆì•½í•˜ê¸° ğŸ§‘
                    </button>
                </div>
            </form>
        </div>
    </div>
    <div th:replace="fragments.html :: help-message"></div>
</div>

</body>

<div th:replace="fragments.html :: form-validation"></div>
<script type="application/javascript" th:inline="javascript">
    $(function () {

        var token = $("meta[name='_csrf']").attr("content");
        var header = $("meta[name='_csrf_header']").attr("content");

        $(document).ajaxSend(function (e, xhr, options) {
            xhr.setRequestHeader(header, token);
        });

        $("#calender").datepicker({
            format: "yyyy-mm-dd",
            startDate: '0d',
            endDate: '+7d',
            language: "ko",
            daysOfWeekDisabled: [1],
            autoclose: true,

        }).on("changeDate", function () {
            getTimePartData();
        });

        function getTimePartData() {
            var curdate = document.getElementById("calender").value;
            console.log($("#calender").datepicker('getDate'));
            console.log(curdate + "??");
            $.ajax({
                url: "/book/get-day-booking-status?date=" + curdate,
                type: "GET",
                dataType: "json",
                contentType: "application/json; charset=utf-8;",
                success: function (data) {
                    console.log(data);
                    var isOverTime = [[${isOverTime}]];
                    console.log(isOverTime);
                    if (!data.weekend) {
                        $('#4-time').show();
                        $('#1-timePart-personnel').text(10 - data.personnel[0] + "ëª… ë‚¨ìŒ ( " + data.personnel[0] + "ëª… ì˜ˆì•½ì¤‘ )");
                        $('#2-timePart-personnel').text(10 - data.personnel[1] + "ëª… ë‚¨ìŒ ( " + data.personnel[1] + "ëª… ì˜ˆì•½ì¤‘ )");
                        $('#3-timePart-personnel').text(10 - data.personnel[2] + "ëª… ë‚¨ìŒ ( " + data.personnel[2] + "ëª… ì˜ˆì•½ì¤‘ )");
                        $('#4-timePart-personnel').text(10 - data.personnel[3] + "ëª… ë‚¨ìŒ ( " + data.personnel[3] + "ëª… ì˜ˆì•½ì¤‘ )");

                        $('#1-timePart-radio')
                    } else {
                        $('#4-time').hide();
                        $('#1-timePart-personnel').text(10 - data.personnel[0] + "ëª… ë‚¨ìŒ ( " + data.personnel[0] + "ëª… ì˜ˆì•½ì¤‘ )");
                        $('#2-timePart-personnel').text(10 - data.personnel[1] + "ëª… ë‚¨ìŒ ( " + data.personnel[1] + "ëª… ì˜ˆì•½ì¤‘ )");
                        $('#3-timePart-personnel').text(10 - data.personnel[2] + "ëª… ë‚¨ìŒ ( " + data.personnel[2] + "ëª… ì˜ˆì•½ì¤‘ )");
                    }
                    console.log("data.personnel[0] : " + data.personnel[0]);
                    console.log("data.personnel[1] : " + data.personnel[1]);
                    console.log("data.personnel[2] : " + data.personnel[2]);
                    console.log("data.weekend : " + data.weekend);
                    $.each(data.personnel, function (idx, val) {
                        console.log("data.personnel [" + idx + "] " + val);
                    });
                    $.each(data, function (idx, val) {
                        console.log("data [" + idx + "] " + val);
                    })
                    $('#time-part').show();

                },
                error: function () {
                    alert("error");
                }

            });
        }
    });
</script>


</html>
